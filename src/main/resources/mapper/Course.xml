<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.enjoytrip.auth.dao.CourseMapper">

    <select id="selectAllMyCourse" parameterType="string" resultType="com.enjoytrip.course.entity.Course">
        select title, is_public, created_at, update_at from course where user_id = #{userid}
    </select>

    <insert id="makeCourse" parameterType="com.enjoytrip.course.entity.Course" >
        insert into course(user_id, title, is_public, created_at, update_at) values(#{userid}, #{title}, #{ispublic}, now(), now())
    </insert>

    <insert id="insertCourse" parameterType="com.enjoytrip.course.entity.CourseAttraction" >
        insert into course_attraction(course_id, attraction_id, comment, turn) values(#{course_id}, #{attraction}, #{attractionid}, #{comment}, #{turn})
    </insert>

    <insert id="commentAdd" parameterType="com.enjoytrip.course.entity.CourseComment" >
        insert into course_comment(course_id, user_id, content, create_at, update_at) values(#{courseid}, #{userid}, #{content}, now(), now())
    </insert>

    <insert id="courseLike" parameterType="com.enjoytrip.course.entity.CourseLike" >
        insert into course_comment(course_id, user_id) values(#{courseid}, #{userid})
    </insert>

    <update id="publicChange" parameterType="com.enjoytrip.course.entity.Course">
        update course set public = #{public} where id = #{id}
    </update>

    <update id="courseChange" parameterType="com.enjoytrip.course.entity.CourseAttraction">
        update course_attraction set attraction_id = #{attractionid}, comment = #{comment}, turn=#{turn} where id = #{id}
    </update>

    <update id="updateAtChange" parameterType="com.enjoytrip.course.entity.Course">
        update course set update=now() where id = #{id}
    </update>

    <update id="coommentChange" parameterType="com.enjoytrip.course.entity.CourseComment">
        update course_comment set content=#{content}, update=now() where id = #{id}
    </update>
</mapper>